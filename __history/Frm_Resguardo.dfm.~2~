object FrmResguardo: TFrmResguardo
  Left = 0
  Top = 0
  Caption = 'Consulta de Resguardos'
  ClientHeight = 449
  ClientWidth = 862
  Color = clBtnFace
  Font.Charset = DEFAULT_CHARSET
  Font.Color = clWindowText
  Font.Height = -11
  Font.Name = 'Tahoma'
  Font.Style = []
  FormStyle = fsMDIChild
  OldCreateOrder = False
  Visible = True
  OnClose = FormClose
  OnCreate = FormCreate
  OnShow = FormShow
  PixelsPerInch = 96
  TextHeight = 13
  object GBx1: TcxGroupBox
    Left = 0
    Top = 0
    Align = alTop
    PanelStyle.Active = True
    ParentFont = False
    TabOrder = 0
    Height = 153
    Width = 862
    object dxLayoutControl1: TdxLayoutControl
      Left = 2
      Top = 2
      Width = 858
      Height = 149
      Align = alClient
      TabOrder = 0
      object ChkGbxFechas: TdxCheckGroupBox
        Left = 10
        Top = 10
        Caption = 'Aplica Fechas de Asignaci'#243'n'
        ParentFont = False
        Style.BorderColor = clWindowFrame
        Style.BorderStyle = ebs3D
        TabOrder = 0
        Height = 95
        Width = 215
        object dxLayoutControl2: TdxLayoutControl
          Left = 2
          Top = 18
          Width = 211
          Height = 75
          Align = alClient
          TabOrder = 0
          object DtEdtFechaI: TcxDateEdit
            Left = 85
            Top = 10
            ParentFont = False
            Properties.ShowTime = False
            Style.BorderColor = clWindowFrame
            Style.BorderStyle = ebs3D
            Style.HotTrack = False
            Style.ButtonStyle = bts3D
            Style.PopupBorderStyle = epbsFrame3D
            TabOrder = 0
            Width = 121
          end
          object DtEdtFechaT: TcxDateEdit
            Left = 85
            Top = 37
            ParentFont = False
            Properties.ShowTime = False
            Style.BorderColor = clWindowFrame
            Style.BorderStyle = ebs3D
            Style.HotTrack = False
            Style.ButtonStyle = bts3D
            Style.PopupBorderStyle = epbsFrame3D
            TabOrder = 1
            Width = 121
          end
          object dxLayoutControl2Group_Root: TdxLayoutGroup
            AlignHorz = ahClient
            AlignVert = avTop
            CaptionOptions.Visible = False
            ButtonOptions.Buttons = <>
            Hidden = True
            ShowBorder = False
            Index = -1
          end
          object dxLayoutControl2Item1: TdxLayoutItem
            Parent = dxLayoutControl2Group_Root
            AlignHorz = ahClient
            CaptionOptions.Text = 'Fecha Inicio'
            Control = DtEdtFechaI
            ControlOptions.ShowBorder = False
            Index = 0
          end
          object dxLayoutControl2Item2: TdxLayoutItem
            Parent = dxLayoutControl2Group_Root
            AlignHorz = ahClient
            CaptionOptions.Text = 'Fecha Termino'
            Control = DtEdtFechaT
            ControlOptions.ShowBorder = False
            Index = 1
          end
        end
      end
      object ChkGbxEquipos: TdxCheckGroupBox
        Left = 231
        Top = 10
        Caption = 'Aplica Equipo '
        CheckBox.Checked = False
        ParentFont = False
        Properties.OnChange = ChkGbxEquiposPropertiesChange
        Style.BorderColor = clWindowFrame
        Style.BorderStyle = ebs3D
        TabOrder = 3
        Height = 61
        Width = 610
        object dxLayoutControl3: TdxLayoutControl
          Left = 2
          Top = 18
          Width = 606
          Height = 41
          Align = alClient
          TabOrder = 0
          object LCmbEquipos: TcxLookupComboBox
            Left = 47
            Top = 10
            ParentFont = False
            Properties.DropDownListStyle = lsFixedList
            Properties.KeyFieldNames = 'sIdInsumo'
            Properties.ListColumns = <
              item
                Caption = 'Familia'
                HeaderAlignment = taCenter
                Width = 100
                FieldName = 'familia'
              end
              item
                Caption = 'Id Equipo'
                HeaderAlignment = taCenter
                Width = 80
                FieldName = 'sIdInsumo'
              end
              item
                Caption = 'No. Serie'
                HeaderAlignment = taCenter
                Width = 80
                FieldName = 'sNumeroserie'
              end
              item
                HeaderAlignment = taCenter
                Width = 250
                FieldName = 'mDescripcion'
              end>
            Properties.ListFieldIndex = 3
            Properties.ListSource = dsEquipos
            Style.BorderColor = clWindowFrame
            Style.BorderStyle = ebs3D
            Style.HotTrack = False
            Style.ButtonStyle = bts3D
            Style.PopupBorderStyle = epbsFrame3D
            TabOrder = 0
            Width = 145
          end
          object dxLayoutControl3Group_Root: TdxLayoutGroup
            AlignHorz = ahClient
            AlignVert = avTop
            ButtonOptions.Buttons = <>
            Hidden = True
            ShowBorder = False
            Index = -1
          end
          object dxLayoutControl3Item1: TdxLayoutItem
            Parent = dxLayoutControl3Group_Root
            AlignHorz = ahClient
            AlignVert = avTop
            CaptionOptions.Text = 'Equipo'
            Control = LCmbEquipos
            ControlOptions.ShowBorder = False
            Index = 0
          end
        end
      end
      object ChkGbxEmpleado: TdxCheckGroupBox
        Left = 231
        Top = 77
        Caption = 'Aplica Empleado'
        CheckBox.Checked = False
        ParentFont = False
        Properties.OnChange = ChkGbxEmpleadoPropertiesChange
        Style.BorderColor = clWindowFrame
        Style.BorderStyle = ebs3D
        TabOrder = 4
        Height = 61
        Width = 322
        object dxLayoutControl4: TdxLayoutControl
          Left = 2
          Top = 18
          Width = 318
          Height = 41
          Align = alClient
          TabOrder = 0
          object LCmbEmpleados: TcxLookupComboBox
            Left = 61
            Top = 10
            ParentFont = False
            Properties.DropDownListStyle = lsFixedList
            Properties.KeyFieldNames = 'sidEMpleado'
            Properties.ListColumns = <
              item
                Caption = 'Ficha Empleado'
                HeaderAlignment = taCenter
                Width = 70
                FieldName = 'sidEMpleado'
              end
              item
                Caption = 'Nombre Completo'
                HeaderAlignment = taCenter
                Width = 200
                FieldName = 'NombreCompleto'
              end
              item
                Caption = 'Puesto'
                HeaderAlignment = taCenter
                Width = 100
                FieldName = 'DescripcionPuesto'
              end
              item
                HeaderAlignment = taCenter
                Width = 100
                FieldName = 'Departamento'
              end>
            Properties.ListFieldIndex = 1
            Properties.ListSource = dsEmpleados
            Style.BorderColor = clWindowFrame
            Style.BorderStyle = ebs3D
            Style.HotTrack = False
            Style.ButtonStyle = bts3D
            Style.PopupBorderStyle = epbsFrame3D
            TabOrder = 0
            Width = 145
          end
          object dxLayoutControl4Group_Root: TdxLayoutGroup
            AlignHorz = ahClient
            AlignVert = avTop
            ButtonOptions.Buttons = <>
            Hidden = True
            ShowBorder = False
            Index = -1
          end
          object dxLayoutControl4Item1: TdxLayoutItem
            Parent = dxLayoutControl4Group_Root
            AlignHorz = ahClient
            AlignVert = avTop
            CaptionOptions.Text = 'Empleado'
            Control = LCmbEmpleados
            ControlOptions.ShowBorder = False
            Index = 0
          end
        end
      end
      object btnConsulta: TcxButton
        Left = 80
        Top = 111
        Width = 75
        Height = 25
        Caption = '&Consultar'
        TabOrder = 1
        OnClick = btnConsultaClick
      end
      object btnExcel: TcxButton
        Left = 150
        Top = 111
        Width = 75
        Height = 25
        Caption = 'btnExcel'
        TabOrder = 2
      end
      object dxLayoutControl1Group_Root: TdxLayoutGroup
        AlignHorz = ahLeft
        AlignVert = avTop
        ButtonOptions.Buttons = <>
        Hidden = True
        LayoutDirection = ldHorizontal
        ShowBorder = False
        Index = -1
      end
      object dxLayoutControl1Item1: TdxLayoutItem
        Parent = dxLayoutControl1Group2
        CaptionOptions.Visible = False
        Control = ChkGbxFechas
        ControlOptions.AutoColor = True
        ControlOptions.ShowBorder = False
        Index = 0
      end
      object dxLayoutControl1Item2: TdxLayoutItem
        Parent = dxLayoutControl1Group1
        CaptionOptions.Text = 'dxCheckGroupBox1'
        CaptionOptions.Visible = False
        Control = ChkGbxEquipos
        ControlOptions.AutoColor = True
        ControlOptions.ShowBorder = False
        Index = 0
      end
      object dxLayoutControl1Item3: TdxLayoutItem
        Parent = dxLayoutControl1Group1
        CaptionOptions.Text = 'dxCheckGroupBox1'
        CaptionOptions.Visible = False
        Control = ChkGbxEmpleado
        ControlOptions.AutoColor = True
        ControlOptions.ShowBorder = False
        Index = 1
      end
      object dxLayoutControl1Group1: TdxLayoutAutoCreatedGroup
        Parent = dxLayoutControl1Group_Root
        Index = 1
        AutoCreated = True
      end
      object dxLayoutControl1Item4: TdxLayoutItem
        Parent = dxLayoutControl1Group3
        AlignHorz = ahCenter
        CaptionOptions.Text = 'cxButton1'
        CaptionOptions.Visible = False
        Control = btnConsulta
        ControlOptions.ShowBorder = False
        Index = 0
      end
      object dxLayoutControl1Group2: TdxLayoutAutoCreatedGroup
        Parent = dxLayoutControl1Group_Root
        Index = 0
        AutoCreated = True
      end
      object dxLayoutControl1Item5: TdxLayoutItem
        Parent = dxLayoutControl1Group3
        AlignHorz = ahRight
        CaptionOptions.Text = 'cxButton1'
        CaptionOptions.Visible = False
        Control = btnExcel
        ControlOptions.ShowBorder = False
        Index = 1
      end
      object dxLayoutControl1Group3: TdxLayoutAutoCreatedGroup
        Parent = dxLayoutControl1Group2
        LayoutDirection = ldHorizontal
        Index = 1
        AutoCreated = True
      end
    end
  end
  object GBx2: TcxGroupBox
    Left = 0
    Top = 153
    Align = alClient
    PanelStyle.Active = True
    ParentFont = False
    TabOrder = 1
    Height = 296
    Width = 862
    object cxGrid1: TcxGrid
      Left = 2
      Top = 2
      Width = 858
      Height = 292
      Align = alClient
      TabOrder = 0
      object cxGrid1DBTableView1: TcxGridDBTableView
        Navigator.Buttons.CustomButtons = <>
        DataController.DataSource = dsConsulta
        DataController.Summary.DefaultGroupSummaryItems = <>
        DataController.Summary.FooterSummaryItems = <>
        DataController.Summary.SummaryGroups = <>
        object cxGrid1DBTableView1Column1: TcxGridDBColumn
          Caption = 'Id Equipo'
          DataBinding.FieldName = 'sIdInsumo'
          HeaderAlignmentHorz = taCenter
          Width = 70
        end
        object cxGrid1DBTableView1Column2: TcxGridDBColumn
          Caption = 'No. Serie'
          DataBinding.FieldName = 'sNumeroSerie'
          HeaderAlignmentHorz = taCenter
          Width = 80
        end
        object cxGrid1DBTableView1Column3: TcxGridDBColumn
          Caption = 'Equipo'
          DataBinding.FieldName = 'descripcion'
          HeaderAlignmentHorz = taCenter
          Width = 200
        end
        object cxGrid1DBTableView1Column4: TcxGridDBColumn
          Caption = 'Modelo'
          DataBinding.FieldName = 'sModelo'
          HeaderAlignmentHorz = taCenter
          Width = 80
        end
        object cxGrid1DBTableView1Column5: TcxGridDBColumn
          Caption = 'Marca'
          DataBinding.FieldName = 'sIdMarca'
          HeaderAlignmentHorz = taCenter
          Width = 90
        end
        object cxGrid1DBTableView1Column6: TcxGridDBColumn
          Caption = 'Ficha Empleado'
          DataBinding.FieldName = 'sIdEmpleado'
          HeaderAlignmentHorz = taCenter
          Width = 80
        end
        object cxGrid1DBTableView1Column7: TcxGridDBColumn
          Caption = 'Nombre Completo'
          DataBinding.FieldName = 'NombreCompleto'
          HeaderAlignmentHorz = taCenter
          Width = 200
        end
        object cxGrid1DBTableView1Column8: TcxGridDBColumn
          Caption = 'Puesto'
          DataBinding.FieldName = 'puesto'
          HeaderAlignmentHorz = taCenter
          Width = 100
        end
        object cxGrid1DBTableView1Column9: TcxGridDBColumn
          Caption = 'Cantidad'
          DataBinding.FieldName = 'dCantidad'
          HeaderAlignmentHorz = taCenter
          Width = 70
        end
        object cxGrid1DBTableView1Column10: TcxGridDBColumn
          Caption = 'Fecha de Asignacion'
          DataBinding.FieldName = 'dFecha_Recepcion'
          HeaderAlignmentHorz = taCenter
          Width = 80
        end
        object cxGrid1DBTableView1Column11: TcxGridDBColumn
          Caption = 'Fecha de Devoluci'#243'n'
          DataBinding.FieldName = 'dFecha_Remocion'
          HeaderAlignmentHorz = taCenter
          Width = 80
        end
        object cxGrid1DBTableView1Column12: TcxGridDBColumn
          Caption = 'Nombre Entrega'
          DataBinding.FieldName = 'sNombreEntrega'
          HeaderAlignmentHorz = taCenter
          Width = 100
        end
        object cxGrid1DBTableView1Column13: TcxGridDBColumn
          Caption = 'Nombre Recibe'
          DataBinding.FieldName = 'sNombreRecibe'
          HeaderAlignmentHorz = taCenter
          Width = 100
        end
        object cxGrid1DBTableView1Column14: TcxGridDBColumn
          Caption = 'Nombre Autoriza'
          DataBinding.FieldName = 'sNombreAutorizacion'
          HeaderAlignmentHorz = taCenter
          Width = 100
        end
      end
      object cxGrid1Level1: TcxGridLevel
        GridView = cxGrid1DBTableView1
      end
    end
  end
  object QrEquipos: TZReadOnlyQuery
    Connection = connection.zConnection
    SQL.Strings = (
      
        'SELECT  i.IID,i.sIdInsumo,substring(i.mDescripcion, 1, 200) as m' +
        'Descripcion,i.sNumeroserie,f.sDescripcion as familia'
      'FROM insumos i'
      'inner join familias f'
      'on(i.sIdGrupo=f.sIdFamilia)'
      'WHERE'
      ' f.iAplicaEquipo="Si" ORDER BY f.sDescripcion,i.sIdInsumo')
    Params = <>
    Left = 368
    Top = 232
  end
  object dsEquipos: TDataSource
    DataSet = QrEquipos
    Left = 376
    Top = 240
  end
  object QrEmpleados: TZReadOnlyQuery
    Connection = connection.zConnection
    SQL.Strings = (
      
        'select e.sidEMpleado,CONCAT(e.sNombreCompleto,'#39' '#39',e.sApellidoPat' +
        'erno,'#39' '#39',e.sApellidoMaterno) as NombreCompleto,'
      'ccp.CodigoCargo,'
      'ccp.titulocargo as DescripcionPuesto,'
      'ree.sDescripcion as Estatus,'
      'dp.titulodepartamento as Departamento,'
      'rp.sDescripcion as Profesion,'
      ''
      '(select min(hab.dFecha) as Alta from rh_historialaltasbajas hab'
      'where hab.sIdEmpleado = e.sIdEmpleado '
      'and hab.sTipo = '#39'Alta'#39') as dFechaInicioLabores,'
      ''
      
        '(select max(hab2.dFecha) as Baja from rh_historialaltasbajas hab' +
        '2'
      'where hab2.sIdEmpleado = e.sIdEmpleado'
      'and hab2.sTipo = '#39'Baja'#39') as dFechaTerminoLabores'
      ' '
      'from empleados e'
      'left join nuc_cargo ccp'
      'on(ccp.IdCargo=e.iId_Puesto)'
      'left join rh_estatusempleados ree'
      'on(ree.iIdEstatus=e.iIdEstatus)'
      'left join nuc_departamento dp'
      'on(dp.iddepartamento=e.iddepartamento)'
      'left join rh_profesiones rp'
      'on(rp.iIdProfesiones=e.iIdProfesiones)'
      ''
      'order by e.idorganizacion, e.iddepartamento, NombreCompleto')
    Params = <>
    Left = 424
    Top = 232
  end
  object dsEmpleados: TDataSource
    DataSet = QrEmpleados
    Left = 424
    Top = 256
  end
  object QrConsulta: TZReadOnlyQuery
    Connection = connection.zConnection
    SQL.Strings = (
      
        'SELECT m.*, CONCAT(e.sNombreCompleto,'#39' '#39',e.sApellidoPaterno,'#39' '#39',' +
        ' e.sApellidoMaterno) as NombreCompleto,  '
      
        'eq.sIdInsumo,eq.mDescripcion as descripcion, eq.sNumeroSerie,eq.' +
        'sModelo,eq.sIdMarca, '
      'eq.sMedida,cp.CodigoCargo,cp.titulocargo as puesto '
      'FROM con_equiposporempleado as m'
      'inner join empleados as e '
      'on (e.sIdEmpleado = m.sIdEmpleado)'
      'left join insumos as eq '
      'on (eq.iId = m.iIdEquipo)'
      'left join nuc_cargo as cp '
      'on (e.iId_Puesto = cp. IdCargo)'
      'WHERE '
      
        #9'(:Empleado=-1 or (:Empleado<>-1 and m.sIdEmpleado = :Empleado))' +
        ' AND'
      '    (:Equipo=-1 or (:Equipo<>-1 and eq.sIdInsumo=:Equipo)) AND'
      
        '    (:FechaI=-1 or (:FechaI<>-1 and m.dFecha_Recepcion between :' +
        'FechaI and :FechaT))')
    Params = <
      item
        DataType = ftUnknown
        Name = 'Empleado'
        ParamType = ptUnknown
      end
      item
        DataType = ftUnknown
        Name = 'Equipo'
        ParamType = ptUnknown
      end
      item
        DataType = ftUnknown
        Name = 'FechaI'
        ParamType = ptUnknown
      end
      item
        DataType = ftUnknown
        Name = 'FechaT'
        ParamType = ptUnknown
      end>
    Left = 536
    Top = 248
    ParamData = <
      item
        DataType = ftUnknown
        Name = 'Empleado'
        ParamType = ptUnknown
      end
      item
        DataType = ftUnknown
        Name = 'Equipo'
        ParamType = ptUnknown
      end
      item
        DataType = ftUnknown
        Name = 'FechaI'
        ParamType = ptUnknown
      end
      item
        DataType = ftUnknown
        Name = 'FechaT'
        ParamType = ptUnknown
      end>
  end
  object dsConsulta: TDataSource
    DataSet = QrConsulta
    Left = 568
    Top = 256
  end
end
